<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HabitQuest - Evolve Your Habits</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--primary:#7C3AED;--primary-light:#A78BFA;--secondary:#3B82F6;--accent:#FF6B6B;--success:#10B981;--warning:#FBBF24;--bg:#F8F7FF;--card:#FFF;--text:#1F2937;--text-light:#6B7280;--border:#E5E7EB}
        body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,var(--bg) 0%,#EDE9FE 100%);min-height:100vh;color:var(--text)}
        .login-container{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
        .login-box{background:var(--card);padding:40px;border-radius:24px;box-shadow:0 20px 60px rgba(124,58,237,.15);max-width:420px;width:100%;text-align:center}
        .login-character{width:120px;height:120px;margin:0 auto 20px;animation:float 3s ease-in-out infinite}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
        .login-box h1{background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:2.5em;margin-bottom:10px}
        .login-box p{color:var(--text-light);margin-bottom:30px}
        .login-type-selector{display:flex;gap:12px;margin-bottom:24px}
        .login-type-btn{flex:1;padding:12px;background:var(--bg);border:2px solid var(--border);border-radius:12px;cursor:pointer;font-weight:600;color:var(--text);transition:all .3s}
        .login-type-btn.active{background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);color:#fff;border-color:var(--primary)}
        .input-group{margin-bottom:20px;text-align:left}
        .input-group label{display:block;margin-bottom:8px;font-weight:600;color:var(--text)}
        .input-group input{width:100%;padding:14px;border:2px solid var(--border);border-radius:12px;font-size:16px;transition:all .3s}
        .input-group input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(124,58,237,.1)}
        .login-btn{width:100%;padding:16px;background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:transform .2s}
        .login-btn:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(124,58,237,.3)}
        .demo-hint{margin-top:20px;padding:12px;background:rgba(124,58,237,.05);border-radius:8px;font-size:14px;color:var(--text-light)}
        .app-container{display:none}
        .navbar{background:var(--card);padding:16px 24px;box-shadow:0 2px 10px rgba(0,0,0,.05);display:flex;justify-content:space-between;align-items:center}
        .nav-brand{font-size:24px;font-weight:700;background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .nav-stats{display:flex;gap:20px;align-items:center}
        .stat-badge{padding:8px 16px;background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);color:#fff;border-radius:20px;font-weight:600;font-size:14px}
        .logout-btn{padding:8px 16px;background:var(--accent);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600}
        .main-content{display:flex;gap:24px;padding:24px;max-width:1400px;margin:0 auto}
        .dashboard{flex:1}
        .tabs{display:flex;gap:12px;margin-bottom:24px;background:var(--card);padding:8px;border-radius:12px}
        .tab{flex:1;padding:12px;background:transparent;border:none;border-radius:8px;cursor:pointer;font-weight:600;color:var(--text-light);transition:all .3s}
        .tab.active{background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);color:#fff}
        .tab-content{display:none}
        .tab-content.active{display:block}
        .section-card{background:var(--card);padding:24px;border-radius:16px;margin-bottom:20px;box-shadow:0 2px 10px rgba(0,0,0,.05)}
        .section-title{font-size:18px;font-weight:700;margin-bottom:16px;color:var(--text)}
        .habit-item{display:flex;align-items:center;gap:12px;padding:16px;background:var(--bg);border-radius:12px;margin-bottom:12px}
        .habit-item.completed .habit-text{opacity:.6;text-decoration:line-through}
        .habit-checkbox{width:28px;height:28px;border:3px solid var(--border);border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0}
        .habit-checkbox.checked{background:var(--success);border-color:var(--success);color:#fff}
        .habit-info{display:flex;align-items:center;gap:12px;flex:1}
        .habit-icon{font-size:28px}
        .habit-text{flex:1;cursor:pointer}
        .habit-details h4{font-size:16px;margin-bottom:4px}
        .habit-details p{font-size:14px;color:var(--text-light)}
        .todo-input{display:flex;gap:12px;margin-bottom:20px}
        .todo-input input{flex:1;padding:12px;border:2px solid var(--border);border-radius:12px;font-size:14px}
        .add-btn{padding:12px 24px;background:var(--primary);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:600}
        .todo-list{list-style:none}
        .todo-item{display:flex;align-items:center;gap:12px;padding:14px;background:var(--bg);border-radius:12px;margin-bottom:10px}
        .todo-item.completed .todo-text{opacity:.6;text-decoration:line-through}
        .todo-checkbox{width:24px;height:24px;border:2px solid var(--border);border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .todo-checkbox.checked{background:var(--success);border-color:var(--success);color:#fff}
        .todo-text{flex:1;cursor:pointer}
        .delete-btn{background:var(--accent);color:#fff;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:12px}
        .learning-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}
        .learning-card{display:flex;align-items:center;gap:12px;padding:16px;background:var(--bg);border-radius:12px;margin-bottom:12px}
        .learning-card.completed .learning-text{opacity:.6;text-decoration:line-through}
        .learning-checkbox{width:24px;height:24px;border:2px solid var(--border);border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .learning-checkbox.checked{background:var(--success);border-color:var(--success);color:#fff}
        .learning-icon{font-size:28px}
        .learning-text{flex:1;cursor:pointer}
        .character-panel{width:360px;background:var(--card);border-radius:16px;padding:24px;box-shadow:0 2px 10px rgba(0,0,0,.05);position:sticky;top:24px;height:fit-content}
        .character-display{text-align:center;margin-bottom:24px}
        .character-stage{font-size:14px;color:var(--primary);font-weight:600;margin-bottom:12px}
        .character-visual{width:200px;height:200px;margin:0 auto 16px;position:relative;display:flex;align-items:center;justify-content:center}
        .character-sprite{font-size:120px;animation:pulse 2s ease-in-out infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .legendary-aura{position:absolute;width:100%;height:100%;border-radius:50%;background:radial-gradient(circle,rgba(124,58,237,.3) 0%,transparent 70%);animation:glow 2s ease-in-out infinite}
        @keyframes glow{0%,100%{opacity:.5;transform:scale(1)}50%{opacity:1;transform:scale(1.1)}}
        .particles{position:absolute;width:100%;height:100%}
        .particle{position:absolute;width:6px;height:6px;background:var(--primary);border-radius:50%;animation:float-p 3s ease-in-out infinite}
        @keyframes float-p{0%,100%{transform:translateY(0) translateX(0);opacity:0}50%{opacity:1}100%{transform:translateY(-50px) translateX(10px);opacity:0}}
        .xp-bar-container{margin-bottom:20px}
        .xp-label{display:flex;justify-content:space-between;margin-bottom:8px;font-size:14px;font-weight:600}
        .xp-bar{height:12px;background:var(--border);border-radius:6px;overflow:hidden}
        .xp-fill{height:100%;background:linear-gradient(90deg,var(--primary) 0%,var(--secondary) 100%);transition:width .5s ease}
        .streak-info{background:var(--bg);padding:16px;border-radius:12px;margin-bottom:16px}
        .streak-number{font-size:36px;font-weight:700;background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-align:center}
        .streak-label{text-align:center;color:var(--text-light);font-size:14px}
        .calendar-container{background:var(--bg);padding:16px;border-radius:12px;margin-bottom:16px}
        .calendar-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
        .calendar-nav{background:var(--primary);color:#fff;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;font-weight:600}
        .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}
        .calendar-day{padding:8px;text-align:center;border-radius:6px;cursor:pointer;font-size:14px}
        .calendar-day.today{background:var(--primary);color:#fff;font-weight:700}
        .calendar-day.has-activity{background:var(--success);color:#fff}
        .calendar-day.selected{background:var(--secondary);color:#fff}
        .calendar-day:hover{background:var(--primary-light);color:#fff}
        .team-section{display:grid;grid-template-columns:1fr 1fr;gap:20px}
        .chat-box{background:var(--bg);border-radius:12px;padding:16px;height:300px;overflow-y:auto}
        .chat-message{background:var(--card);padding:12px;border-radius:12px;margin-bottom:10px}
        .chat-user{font-weight:600;color:var(--primary);font-size:14px;margin-bottom:4px}
        .chat-text{font-size:14px;color:var(--text)}
        .chat-input-container{display:flex;gap:12px;margin-top:12px}
        .leaderboard-item{display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg);border-radius:12px;margin-bottom:10px}
        .rank{font-size:24px;font-weight:700;color:var(--primary);min-width:40px}
        .team-task-item{display:flex;align-items:center;gap:12px;padding:14px;background:var(--bg);border-radius:12px;margin-bottom:10px}
        .team-task-item.completed .team-task-text{opacity:.6;text-decoration:line-through}
        .team-task-checkbox{width:24px;height:24px;border:2px solid var(--border);border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .team-task-checkbox.checked{background:var(--success);border-color:var(--success);color:#fff}
        .team-task-text{flex:1;cursor:pointer}
        @media (max-width:968px){.main-content{flex-direction:column}.character-panel{width:100%;position:static}.team-section{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-character">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="35" fill="#A78BFA"/>
                    <circle cx="40" cy="45" r="4" fill="#1F2937"/>
                    <circle cx="60" cy="45" r="4" fill="#1F2937"/>
                    <path d="M 35 60 Q 50 70 65 60" stroke="#1F2937" stroke-width="3" fill="none" stroke-linecap="round"/>
                </svg>
            </div>
            <h1>HabitQuest</h1>
            <p>Evolve your habits, evolve yourself</p>
            <div class="login-type-selector">
                <button type="button" class="login-type-btn active" onclick="selectLoginType('individual')">Individual</button>
                <button type="button" class="login-type-btn" onclick="selectLoginType('team')">Team</button>
            </div>
            <form id="loginForm">
                <div id="individualFields">
                    <div class="input-group">
                        <label>Email</label>
                        <input type="email" id="loginEmail" placeholder="your@email.com">
                    </div>
                    <div class="input-group">
                        <label>Password</label>
                        <input type="password" id="loginPassword" placeholder="Min 6 characters">
                    </div>
                </div>
                <div id="teamFields" style="display:none">
                    <div class="input-group">
                        <label>Team Code</label>
                        <input type="text" id="teamCode" placeholder="Enter team code">
                    </div>
                </div>
                <button type="submit" class="login-btn">Start Your Quest</button>
            </form>
            <div class="demo-hint">üí° Demo: demo@quest.com / demo123</div>
        </div>
    </div>
    <div id="appContainer" class="app-container">
        <nav class="navbar">
            <div class="nav-brand">üéÆ HabitQuest</div>
            <div class="nav-stats">
                <div class="stat-badge" id="streakBadge">üî• 0 Day Streak</div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </nav>
        <div class="main-content">
            <div class="dashboard">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('health')">ü´Ä Health</button>
                    <button class="tab" onclick="switchTab('todos')">‚úÖ Todos</button>
                    <button class="tab" onclick="switchTab('learning')">üìö Learning</button>
                    <button class="tab" onclick="switchTab('team')">üë• Team</button>
                </div>
                <div id="healthTab" class="tab-content active">
                    <div class="section-card">
                        <div class="section-title">Daily Health Goals</div>
                        <div id="healthHabits"></div>
                    </div>
                </div>
                <div id="todosTab" class="tab-content">
                    <div class="section-card">
                        <div class="section-title">Personal Tasks</div>
                        <div class="todo-input">
                            <input type="text" id="todoInput" placeholder="Add a new task...">
                            <button class="add-btn" onclick="addTodo()">Add</button>
                        </div>
                        <ul id="todoList" class="todo-list"></ul>
                    </div>
                </div>
                <div id="learningTab" class="tab-content">
                    <div class="section-card">
                        <div class="section-title">Reading</div>
                        <div id="readingList"></div>
                    </div>
                    <div class="section-card">
                        <div class="section-title">Skills</div>
                        <div class="todo-input">
                            <input type="text" id="skillInput" placeholder="Add a skill you're learning...">
                            <button class="add-btn" onclick="addSkill()">Add</button>
                        </div>
                        <div id="skillsList"></div>
                    </div>
                    <div class="section-card">
                        <div class="section-title">Language</div>
                        <div class="todo-input">
                            <input type="text" id="languageInput" placeholder="Which language are you learning?">
                            <button class="add-btn" onclick="addLanguage()">Add</button>
                        </div>
                        <div id="languageList"></div>
                    </div>
                </div>
                <div id="teamTab" class="tab-content">
                    <div class="section-card">
                        <div class="section-title">Team Workspace</div>
                        <div class="team-section">
                            <div>
                                <h4 style="margin-bottom:12px;font-size:16px">üí¨ Team Chat</h4>
                                <div class="chat-box" id="chatBox"></div>
                                <div class="chat-input-container">
                                    <input type="text" id="chatInput" placeholder="Type a message..." style="flex:1;padding:10px;border:2px solid var(--border);border-radius:8px">
                                    <button class="add-btn" onclick="sendMessage()">Send</button>
                                </div>
                            </div>
                            <div>
                                <h4 style="margin-bottom:12px;font-size:16px">üèÜ Leaderboard</h4>
                                <div id="leaderboard"></div>
                            </div>
                        </div>
                    </div>
                    <div class="section-card">
                        <div class="section-title">Team Tasks</div>
                        <div class="todo-input">
                            <input type="text" id="teamTaskInput" placeholder="Add a team task...">
                            <button class="add-btn" onclick="addTeamTask()">Add</button>
                        </div>
                        <div id="teamTasks"></div>
                    </div>
                </div>
            </div>
            <div class="character-panel">
                <div class="character-display">
                    <div class="character-stage" id="characterStage">Dormant</div>
                    <div class="character-visual" id="characterVisual">
                        <div class="character-sprite" id="characterSprite">üí§</div>
                    </div>
                </div>
                <div class="xp-bar-container">
                    <div class="xp-label"><span>XP</span><span id="xpDisplay">0 / 100</span></div>
                    <div class="xp-bar"><div class="xp-fill" id="xpFill" style="width:0%"></div></div>
                </div>
                <div class="streak-info">
                    <div class="streak-number" id="streakDisplay">0</div>
                    <div class="streak-label">Day Streak</div>
                </div>
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="calendar-nav" onclick="changeMonth(-1)">‚óÄ</button>
                        <span id="calendarMonth" style="font-weight:600"></span>
                        <button class="calendar-nav" onclick="changeMonth(1)">‚ñ∂</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid"></div>
                </div>
                <div style="background:var(--bg);padding:16px;border-radius:12px;font-size:14px;line-height:1.6">
                    <strong>Evolution Path:</strong><br>üåë Dormant (0 days)<br>üå± Seedling (1-3 days)<br>‚öîÔ∏è Adventurer (4-7 days)<br>üîÆ Warrior (8-14 days)<br>üëë Champion (15-21 days)<br>‚ú® Legendary (22+ days)
                </div>
            </div>
        </div>
    </div>
    <script>
        let g={user:null,loginType:'individual',xp:0,dailyXP:0,streak:0,lastActiveDate:null,habits:[{id:1,name:'Steps',target:'5,000 steps',icon:'üö∂',completed:false,xp:10},{id:2,name:'Workout',target:'30 minutes',icon:'üí™',completed:false,xp:10},{id:3,name:'Water',target:'12 glasses',icon:'üíß',completed:false,xp:10},{id:4,name:'Meditation',target:'20 minutes',icon:'üßò',completed:false,xp:10}],todos:[],reading:[{id:1,name:'Read for 30 minutes',icon:'üìñ',completed:false,xp:10}],skills:[],languages:[],teamTasks:[],activityHistory:{},calendarView:{month:new Date().getMonth(),year:new Date().getFullYear()},selectedDate:null};
        const stages=[{min:0,max:0,name:'Dormant',emoji:'üí§'},{min:1,max:3,name:'Seedling',emoji:'üå±'},{min:4,max:7,name:'Adventurer',emoji:'‚öîÔ∏è'},{min:8,max:14,name:'Warrior',emoji:'üîÆ'},{min:15,max:21,name:'Champion',emoji:'üëë'},{min:22,max:999,name:'Legendary',emoji:'‚ú®'}];
        function selectLoginType(t){g.loginType=t;document.querySelectorAll('.login-type-btn').forEach(b=>b.classList.remove('active'));event.target.classList.add('active');if(t==='individual'){document.getElementById('individualFields').style.display='block';document.getElementById('teamFields').style.display='none'}else{document.getElementById('individualFields').style.display='none';document.getElementById('teamFields').style.display='block'}}
        document.getElementById('loginForm').addEventListener('submit',e=>{e.preventDefault();if(g.loginType==='individual'){const email=document.getElementById('loginEmail').value,password=document.getElementById('loginPassword').value;if(email.includes('@')&&password.length>=6){g.user=email;loadGame();document.getElementById('loginPage').style.display='none';document.getElementById('appContainer').style.display='block'}else alert('Please enter a valid email and password (min 6 characters)')}else{const code=document.getElementById('teamCode').value;if(code.trim().length>0){g.user='team_'+code;loadGame();document.getElementById('loginPage').style.display='none';document.getElementById('appContainer').style.display='block'}else alert('Please enter a team code')}});
        function logout(){saveGame();document.getElementById('loginPage').style.display='flex';document.getElementById('appContainer').style.display='none';g.user=null}
        function switchTab(n){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));event.target.classList.add('active');document.getElementById(n+'Tab').classList.add('active')}
        function renderHabits(){document.getElementById('healthHabits').innerHTML=g.habits.map(h=>`<div class="habit-item ${h.completed?'completed':''}"><div class="habit-checkbox ${h.completed?'checked':''}" onclick="toggleHabit(${h.id})">${h.completed?'‚úì':''}</div><div class="habit-info"><div class="habit-icon">${h.icon}</div><div class="habit-text" onclick="toggleHabit(${h.id})"><h4>${h.name}</h4><p>${h.target}</p></div></div><button class="delete-btn" onclick="deleteHabit(${h.id})">Delete</button></div>`).join('')}
        function toggleHabit(id){const h=g.habits.find(x=>x.id===id);if(!h.completed){h.completed=true;addXP(h.xp)}else{h.completed=false;removeXP(h.xp)}renderHabits();saveGame()}
        function deleteHabit(id){g.habits=g.habits.filter(h=>h.id!==id);renderHabits();saveGame()}
        function addTodo(){const inp=document.getElementById('todoInput');if(inp.value.trim()){g.todos.push({id:Date.now(),text:inp.value,completed:false,xp:3});inp.value='';renderTodos();saveGame()}}
        function renderTodos(){document.getElementById('todoList').innerHTML=g.todos.map(t=>`<li class="todo-item ${t.completed?'completed':''}"><div class="todo-checkbox ${t.completed?'checked':''}" onclick="toggleTodo(${t.id})">${t.completed?'‚úì':''}</div><span class="todo-text" onclick="toggleTodo(${t.id})">${t.text}</span><button class="delete-btn" onclick="deleteTodo(${t.id})">Delete</button></li>`).join('')}
        function toggleTodo(id){const t=g.todos.find(x=>x.id===id);if(!t.completed){t.completed=true;addXP(t.xp)}else{t.completed=false;removeXP(t.xp)}renderTodos();saveGame()}
        function deleteTodo(id){g.todos=g.todos.filter(t=>t.id!==id);renderTodos();saveGame()}
        function renderReading(){document.getElementById('readingList').innerHTML=g.reading.map(r=>`<div class="learning-card ${r.completed?'completed':''}"><div class="learning-checkbox ${r.completed?'checked':''}" onclick="toggleReading(${r.id})">${r.completed?'‚úì':''}</div><div class="learning-icon">${r.icon}</div><div class="learning-text" onclick="toggleReading(${r.id})">${r.name}</div><button class="delete-btn" onclick="deleteReading(${r.id})">Delete</button></div>`).join('')}
        function toggleReading(id){const r=g.reading.find(x=>x.id===id);if(!r.completed){r.completed=true;addXP(r.xp)}else{r.completed=false;removeXP(r.xp)}renderReading();saveGame()}
        function deleteReading(id){g.reading=g.reading.filter(r=>r.id!==id);renderReading();saveGame()}
        function addSkill(){const inp=document.getElementById('skillInput');if(inp.value.trim()){g.skills.push({id:Date.now(),name:inp.value,completed:false,xp:10});inp.value='';renderSkills();saveGame()}}
        function renderSkills(){document.getElementById('skillsList').innerHTML=g.skills.map(s=>`<div class="learning-card ${s.completed?'completed':''}"><div class="learning-checkbox ${s.completed?'checked':''}" onclick="toggleSkill(${s.id})">${s.completed?'‚úì':''}</div><div class="learning-icon">üõ†Ô∏è</div><div class="learning-text" onclick="toggleSkill(${s.id})">${s.name}</div><button class="delete-btn" onclick="deleteSkill(${s.id})">Delete</button></div>`).join('')}
        function toggleSkill(id){const s=g.skills.find(x=>x.id===id);if(!s.completed){s.completed=true;addXP(s.xp)}else{s.completed=false;removeXP(s.xp)}renderSkills();saveGame()}
        function deleteSkill(id){g.skills=g.skills.filter(s=>s.id!==id);renderSkills();saveGame()}
        function addLanguage(){const inp=document.getElementById('languageInput');if(inp.value.trim()){g.languages.push({id:Date.now(),name:inp.value,completed:false,xp:10});inp.value='';renderLanguages();saveGame()}}
        function renderLanguages(){document.getElementById('languageList').innerHTML=g.languages.map(l=>`<div class="learning-card ${l.completed?'completed':''}"><div class="learning-checkbox ${l.completed?'checked':''}" onclick="toggleLanguage(${l.id})">${l.completed?'‚úì':''}</div><div class="learning-icon">üó£Ô∏è</div><div class="learning-text" onclick="toggleLanguage(${l.id})">${l.name}</div><button class="delete-btn" onclick="deleteLanguage(${l.id})">Delete</button></div>`).join('')}
        function toggleLanguage(id){const l=g.languages.find(x=>x.id===id);if(!l.completed){l.completed=true;addXP(l.xp)}else{l.completed=false;removeXP(l.xp)}renderLanguages();saveGame()}
        function deleteLanguage(id){g.languages=g.languages.filter(l=>l.id!==id);renderLanguages();saveGame()}
        function addXP(a){if(g.dailyXP>=100)return;g.dailyXP=Math.min(100,g.dailyXP+a);g.xp+=a;updateXPDisplay();updateCharacter();logActivity();renderTeam();showNotification(`+${a} XP`)}
        function removeXP(a){g.dailyXP=Math.max(0,g.dailyXP-a);g.xp=Math.max(0,g.xp-a);updateXPDisplay();logActivity();renderTeam()}
        function updateXPDisplay(){const p=Math.min(100,(g.dailyXP/100)*100);document.getElementById('xpFill').style.width=p+'%';document.getElementById('xpDisplay').textContent=`${g.dailyXP} / 100`}
        function updateCharacter(){const s=stages.find(x=>g.streak>=x.min&&g.streak<=x.max);document.getElementById('characterStage').textContent=s.name;document.getElementById('characterSprite').textContent=s.emoji;const v=document.getElementById('characterVisual');if(s.name==='Legendary'){if(!v.querySelector('.legendary-aura'))v.innerHTML=`<div class="legendary-aura"></div><div class="particles"><div class="particle" style="left:20%;animation-delay:0s"></div><div class="particle" style="left:50%;animation-delay:.5s"></div><div class="particle" style="left:80%;animation-delay:1s"></div></div><div class="character-sprite" id="characterSprite">${s.emoji}</div>`}else v.innerHTML=`<div class="character-sprite" id="characterSprite">${s.emoji}</div>`}
        function updateStreak(){const today=new Date().toDateString(),last=g.lastActiveDate;if(!last){g.streak=1;g.dailyXP=0}else if(last!==today){const y=new Date();y.setDate(y.getDate()-1);if(last===y.toDateString()){if(g.dailyXP>=100)g.streak++;else g.streak=1}else{g.streak=1}g.dailyXP=0}g.lastActiveDate=today;document.getElementById('streakDisplay').textContent=g.streak;document.getElementById('streakBadge').textContent=`üî• ${g.streak} Day Streak`;updateCharacter()}
        function logActivity(){const today=new Date().toDateString();if(!g.activityHistory[today])g.activityHistory[today]={xp:0,todos:0,habits:0};g.activityHistory[today].xp=g.dailyXP;g.activityHistory[today].todos=g.todos.filter(t=>t.completed).length;g.activityHistory[today].habits=g.habits.filter(h=>h.completed).length;renderCalendar();saveGame()}
        function renderCalendar(){const m=g.calendarView.month,y=g.calendarView.year;const monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];document.getElementById('calendarMonth').textContent=`${monthNames[m]} ${y}`;const firstDay=new Date(y,m,1).getDay(),daysInMonth=new Date(y,m+1,0).getDate();const grid=document.getElementById('calendarGrid');grid.innerHTML='';for(let i=0;i<firstDay;i++)grid.innerHTML+='<div></div>';for(let d=1;d<=daysInMonth;d++){const date=new Date(y,m,d).toDateString();const today=new Date().toDateString();const hasActivity=g.activityHistory[date]?'has-activity':'';const isToday=date===today?'today':'';const isSelected=date===g.selectedDate?'selected':'';grid.innerHTML+=`<div class="calendar-day ${isToday} ${hasActivity} ${isSelected}" onclick="selectDate('${date}')">${d}</div>`}}
        function changeMonth(d){g.calendarView.month+=d;if(g.calendarView.month>11){g.calendarView.month=0;g.calendarView.year++}if(g.calendarView.month<0){g.calendarView.month=11;g.calendarView.year--}renderCalendar()}
        function selectDate(date){g.selectedDate=date;renderCalendar();const activity=g.activityHistory[date];if(activity){showNotification(`${date}: ${activity.xp} XP, ${activity.todos} todos, ${activity.habits} habits`)}else{showNotification(`${date}: No activity recorded`)}}
        function renderTeam(){document.getElementById('chatBox').innerHTML=[{user:'Nandana',text:'Lets wrap up incomplete items today'},{user:'Krishna',text:'Sure'},{user:'Vismaya',text:'I am in!'}].map(m=>`<div class="chat-message"><div class="chat-user">${m.user}</div><div class="chat-text">${m.text}</div></div>`).join('');const l=[{name:'Nandana',streak:28,xp:2100},{name:'Krishna',streak:25,xp:1950},{name:'Vismaya',streak:20,xp:1600},{name:'Sreedevi',streak:18,xp:1400},{name:'You',streak:g.streak,xp:g.xp},{name:'Varsha',streak:15,xp:1200}].sort((a,b)=>b.xp-a.xp);document.getElementById('leaderboard').innerHTML=l.map((u,i)=>`<div class="leaderboard-item"><div class="rank">#${i+1}</div><div style="flex:1"><div style="font-weight:600">${u.name}</div><div style="font-size:12px;color:var(--text-light)">üî• ${u.streak} days ‚Ä¢ ${u.xp} XP</div></div></div>`).join('');renderTeamTasks()}
        function addTeamTask(){const inp=document.getElementById('teamTaskInput');if(inp.value.trim()){g.teamTasks.push({id:Date.now(),text:inp.value,completed:false,xp:3});inp.value='';renderTeamTasks();saveGame()}}
        function renderTeamTasks(){document.getElementById('teamTasks').innerHTML=g.teamTasks.map(t=>`<div class="team-task-item ${t.completed?'completed':''}"><div class="team-task-checkbox ${t.completed?'checked':''}" onclick="toggleTeamTask(${t.id})">${t.completed?'‚úì':''}</div><span class="team-task-text" onclick="toggleTeamTask(${t.id})">${t.text}</span><button class="delete-btn" onclick="deleteTeamTask(${t.id})">Delete</button></div>`).join('')}
        function toggleTeamTask(id){const t=g.teamTasks.find(x=>x.id===id);if(!t.completed){t.completed=true;addXP(t.xp)}else{t.completed=false;removeXP(t.xp)}renderTeamTasks();saveGame()}
        function deleteTeamTask(id){g.teamTasks=g.teamTasks.filter(t=>t.id!==id);renderTeamTasks();saveGame()}
        function sendMessage(){const inp=document.getElementById('chatInput');if(inp.value.trim()){const box=document.getElementById('chatBox');box.innerHTML+=`<div class="chat-message"><div class="chat-user">You</div><div class="chat-text">${inp.value}</div></div>`;inp.value='';box.scrollTop=box.scrollHeight;setTimeout(()=>{box.innerHTML+=`<div class="chat-message"><div class="chat-user">Krishna</div><div class="chat-text">That sounds great! üëç</div></div>`;box.scrollTop=box.scrollHeight},1000)}}
        function showNotification(m){const n=document.createElement('div');n.textContent=m;n.style.cssText='position:fixed;top:80px;right:20px;background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);color:#fff;padding:16px 24px;border-radius:12px;font-weight:600;box-shadow:0 8px 20px rgba(124,58,237,.3);z-index:1000;animation:slideIn .3s ease';document.body.appendChild(n);setTimeout(()=>{n.style.animation='slideOut .3s ease';setTimeout(()=>n.remove(),300)},2000)}
        function saveGame(){localStorage.setItem('habitquest_'+g.user,JSON.stringify(g))}
        function loadGame(){const s=localStorage.getItem('habitquest_'+g.user);if(s){const d=JSON.parse(s);g={...g,...d}}updateStreak();updateXPDisplay();updateCharacter();renderHabits();renderTodos();renderReading();renderSkills();renderLanguages();renderTeam();renderCalendar()}
        const st=document.createElement('style');st.textContent='@keyframes slideIn{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes slideOut{from{transform:translateX(0);opacity:1}to{transform:translateX(400px);opacity:0}}';document.head.appendChild(st);
    </script>
</body>
</html>